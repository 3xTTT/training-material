<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Galaxy Training!</title>
        <link media="all" href="https://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/landing_page.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/tutorial.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/font-awesome.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/syntax_highlighting.css">
        <meta name="viewport" content="width=device-width">
    </head>
    <body>
        <div class="wrapper">
            


<header>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a id="site-title" class="navbar-brand" href="https://wiki.galaxyproject.org/Teach/GTN">
              <img class="pull-left img-responsive" src="https://galaxyproject.github.io/training-material///assets/images/GTN.png">
            </a>
            <a id="site-title" class="navbar-brand name-holder" href="https://galaxyproject.github.io/training-material//topics/sequence-analysis/tutorials/">
              
            </a>
          </div>

          <div class="collapse navbar-collapse" id="navbar">

            <ul id="main-menu" class="nav navbar-nav navbar-right">
              <li><a href="https://galaxyproject.github.io/training-material/" title="Back to front page"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="https://galaxyproject.github.io/training-material//topics/sequence-analysis" title="Go back to list of tutorials"><i class="fa fa-file-text-o"></i> sequence-analysis</a></li>

              
                <li><a href="https://galaxyproject.github.io/training-material//topics/sequence-analysis/slides" title="Slides for this tutorial"><i class="fa fa-graduation-cap"></i> Introduction slides</a></li>
              
              <!--<li><a href="https://galaxyproject.github.io/training-material//sequence-analysis/slides//"><i class="fa fa-file-powerpoint-o"></i> Associated slides</a></li>-->

              

              

              
                <li><a href="" title="Links to data"><i class="fa fa-folder-open"></i> Input Dataset</a></li>
              

              
                <li><a href="https://galaxyproject.github.io/training-material//topics/sequence-analysis#references" title="References"><i class="fa fa-book"></i> Literature</a></li>
              

            </ul>
          </div>
        </div>
    </nav>
</header>

<section class="tutorial">
    <h1></h1>

    <blockquote class="overview">
        <h3>Overview</h3>

        <p class="bold"> <img class="emoji" title=":grey_question:" alt=":grey_question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2754.png" height="20" width="20" align="absmiddle"> Questions</p>
        <ul>
        
        </ul>

        <p class="bold"> <img class="emoji" title=":dart:" alt=":dart:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f3af.png" height="20" width="20" align="absmiddle"> Objectives</p>
        <ul>
        
        </ul>

        
        <p class="bold"> <img class="emoji" title=":heavy_check_mark:" alt=":heavy_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" height="20" width="20" align="absmiddle"> Requirements</p>
        <ul>
          
            <li>
                
                <a href="https://galaxyproject.github.io/training-material//topics//introduction/">Galaxy introduction</a>
                
            </li>
          
          
        </ul>
        

        <p><span class="bold"> <img class="emoji" title=":hourglass:" alt=":hourglass:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/231b.png" height="20" width="20" align="absmiddle"> Time estimation:</span> </p>

    </blockquote>

<h1 class="no_toc" id="introduction">Introduction</h1>

<p>Genome annotation is the process of attaching biological information to sequences.
It consists of three main steps:</p>

<ul>
  <li>identifying portions of the genome that do not code for proteins</li>
  <li>identifying elements on the genome, a process called gene prediction, and</li>
  <li>attaching biological information to these elements.</li>
</ul>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#introduction-into-file-formats" id="markdown-toc-introduction-into-file-formats">Introduction into File Formats</a></li>
  <li>
<a href="#structural-annotation" id="markdown-toc-structural-annotation">Structural Annotation</a>    <ol>
      <li><a href="#sequence-features" id="markdown-toc-sequence-features">Sequence Features</a></li>
      <li><a href="#gene-prediction" id="markdown-toc-gene-prediction">Gene Prediction</a></li>
    </ol>
  </li>
  <li>
<a href="#functional-annotation" id="markdown-toc-functional-annotation">Functional Annotation</a>    <ol>
      <li><a href="#similarity-searches-blast" id="markdown-toc-similarity-searches-blast">Similarity Searches (BLAST)</a></li>
      <li><a href="#more-similarity-search-tools-in-galaxy" id="markdown-toc-more-similarity-search-tools-in-galaxy">More Similarity Search Tools in Galaxy</a></li>
      <li><a href="#identification-of-gene-clusters" id="markdown-toc-identification-of-gene-clusters">Identification of Gene Clusters</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 id="introduction-into-file-formats">Introduction into File Formats</h1>

<p><strong>FASTA</strong></p>

<blockquote>
  <p>DNA and protein sequences are written in FASTA format where you have in the first line a “&gt;” followed by the description. In the second line the sequence starts.</p>
</blockquote>

<p><img src="../../images/fasta_format.png" alt="FASTA file"></p>

<p><strong>GFF3</strong></p>

<blockquote>
  <p>The general feature format (gene-finding format, generic feature format, GFF) is a file format used for describing genes and other features of DNA, RNA and protein sequences.</p>
</blockquote>

<p><img src="../../images/gff3_format.png" width="70%"></p>

<p><strong>GENBANK</strong></p>

<blockquote>
  <p>The genbank sequence format is a rich format for storing sequences and associated annotations.</p>
</blockquote>

<p><img src="../../images/gb_full.png" alt="genbank file"></p>

<h1 id="structural-annotation">Structural Annotation</h1>

<p>For the genome annotation we use a piece of the <em>Aspergillus fumigatus</em> <a href="../input_data/Aspergillus_sequence.fasta">genome sequence</a> as input file.</p>

<h2 id="sequence-features">Sequence Features</h2>

<p>First we want to get some general information about our sequence.</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-sequence-composition">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Sequence composition</h3>

  <ol>
    <li>Count the number of bases in your sequence (<strong>compute sequence length</strong>)</li>
    <li>Check for sequence composition and GC content (<strong>geecee</strong>).</li>
    <li>Plot the sequence composition as bar chart.</li>
  </ol>

  <p><img src="../../images/barchart_sequencecomposition.png" width="30%"></p>

</blockquote>

<h2 id="gene-prediction">Gene Prediction</h2>

<p>At first you need to identify those structures of the genome which code for proteins. This step of annotation is called “structural annotation”. It contains the identification and location of open reading frames (ORFs), identification of gene structures and coding regions, and the location of regulatory motifs. Galaxy contains several tools for the structural annotation. Tools for gene prediction are <strong>Augustus</strong> (for eukaryotes and prokaryotes) and <strong>glimmer3</strong> (only for prokaryotes).</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-gene-prediction">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Gene prediction</h3>

  <p>We use <strong>Augustus</strong> for gene prediction.</p>
  <ol>
    <li>Use the genome sequence (FASTA file) as input.</li>
    <li>Choose the right <em>model organism</em>, <em>gff</em> format output.</li>
    <li>Select all possible output options.</li>
  </ol>

  <p><img src="../../images/augustus.png" alt="augustus"></p>

  <p>Augustus will provide three output files: <em>gff3</em>, <em>coding sequences</em> (CDS) and <em>protein sequences</em>.</p>

  <blockquote class="question">
    <h3 id="question-question">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Question</h3>

    <p>How many genes are predicted?</p>

    <details>
<summary>Click to view answer</summary>
Check the output: <a href="../../images/augustus_out.png">augustus_output</a>
</details>
  </blockquote>

</blockquote>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-trna-and-tmrna-prediction">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: tRNA and tmRNA Prediction</h3>

  <p>Use <strong>Aragorn</strong> for tRNA and tmRNA prediction.</p>
  <ol>
    <li>As input file use the <em>Aspergillus</em> genome sequence. You can choose the genetic code (e.g. bacteria).</li>
    <li>
      <p>Select the topology of your genome (circular or linear).</p>

      <blockquote class="question">
        <h3 id="question-question-1">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Question</h3>

        <p>Are there tRNAs or tmRNAs in the sequence?</p>

        <details>
<summary></summary>
</details>
      </blockquote>
    </li>
  </ol>

</blockquote>

<blockquote class="tip">
  <h3 id="bulb-tip">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip:</h3>

  <p>read more about <strong>Aragorn</strong> <a href="https://nar.oxfordjournals.org/content/32/1/11.full.pdf+html">here</a>.</p>
</blockquote>

<h1 id="functional-annotation">Functional Annotation</h1>

<h2 id="similarity-searches-blast">Similarity Searches (BLAST)</h2>

<p>Functional gene annotation means the description of the biochemical and biological function of proteins. Possible analyses to annotate genes can be for example:</p>

<ul>
  <li>similarity searches</li>
  <li>gene cluster prediction for secondary metabolites</li>
  <li>identification of transmembrane domains in protein sequences</li>
  <li>finding gene ontology terms</li>
  <li>pathway information</li>
</ul>

<p>For similarity searches we use <em>NCBI BLAST+ blastp</em> to find similar proteins in a protein database.</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on--similarity-search">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on:  Similarity search</h3>

  <ol>
    <li>
<img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle"> As input file, select the protein sequences from Augustus.</li>
    <li>Choose the protein BLAST database <em>SwissProt</em> and the output format <em>xml</em>.</li>
  </ol>

  <p><img src="../../images/blastP.png" width="70%"></p>

  <ol class="question">
    <li>
      <p>Parsing the xml output (<strong>Parse blast XML output</strong>) results in changing the format style into tabular.</p>

      <blockquote>
        <h3 id="question-questions">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <p>What information do you see in the BLAST output?</p>

        <details>
<summary></summary>
</details>
      </blockquote>
    </li>
  </ol>

  <p>From BLAST search results we want to get only the best hit for each protein.</p>
  <ol class="question">
    <li>
      <p><img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle"> Therefore apply the tool <strong>BLAST top hit descriptions</strong> with <em>number of descriptions =1</em> on the xml output file.</p>

      <blockquote>
        <h3 id="question-question-2">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Question</h3>

        <p>For how many proteins we do not get a BLAST hit?</p>

        <details>
<summary></summary>
</details>
      </blockquote>
    </li>
  </ol>

  <ol>
    <li>
<img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle"> Choose the tool <strong>Select lines that match an expression</strong> and enter the following information: <em>Select lines from</em> [select the BLAST top hit descriptions result file]; <em>that</em> [not matching]; <em>the pattern</em> [gi].</li>
  </ol>

  <p><img src="../../images/selectlines.png" width="50%"></p>

  <blockquote>
    <p><img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> The result file will contain all proteins which do not have an entry in the second column and therefore have no similar protein in the SwissProt database.</p>

    <p><img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> For functional description of those proteins we want to search for motifs or domains which may classify them more. To get a protein sequence FASTA file with only the not annotated proteins, use the tool <strong>Filter sequences by ID from a tabular file</strong> and select for <em>Sequence file to filter on the identifiers</em> [Augustus protein sequences] and for <em>Tabular file containing sequence identifiers</em> the protein file with not annotated sequences. The output file is a FASTA file with only those sequences without description.</p>
  </blockquote>

</blockquote>

<p>This file will be the input for more detailed analysis:</p>

<ul>
  <li>
    <p><strong>Interproscan</strong> is a functional prediction tool. Select all applications and run it on your protein file.</p>
  </li>
  <li>
    <p><strong>WolfPSort</strong> predicts eukaryote protein subcellular localization. Filter the result file for the best ranked localization hit. Use <strong>Filter data on any column using simple expressions</strong> with <em>c4==1</em>. The parameter c4==1 means: filter and keep all results where in column 4 is a “1”.</p>
  </li>
  <li>
    <p><strong>TMHMM</strong> finds transmembrane domains in protein sequences. The number of amino acids in transmembrane helices should be &gt;18. This information can be found in column 3. Filter the result file <em>c3&gt;17.99</em>.</p>
  </li>
  <li>
    <p><strong>BLAST2GO</strong> maps BLAST results to GO annotation terms.</p>
  </li>
</ul>

<h3 id="blast-programs">BLAST Programs</h3>

<p><img src="../../images/blastprograms.png" alt="BLAST programs"></p>

<p><img src="../../images/blast%20database.png" alt="BLAST databases"></p>

<blockquote class="tip">
  <h3 id="bulb-tip-1">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip:</h3>

  <p>If you have an organism which is not available in a BLAST database, you can use its genome sequence in FASTA file for BLAST searches “sequence file against sequence file”. If you need to search in these sequences on a regularly basis, you can create a own BLAST database from the sequences of the organism. The advantage of having a own database for your organism is the duration of the BLAST search which speeds up a lot.</p>
</blockquote>

<p><strong>NCBI BLAST+ makeblastdb</strong> creates a BLAST database from your own FASTA sequence file. Molecule type of input is protein or nucleotide.</p>

<blockquote class="tip">
  <h3 id="bulb-tip-further-reading-about-blast-tools-in-galaxy">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Further Reading about BLAST Tools in Galaxy</h3>

  <p>Cock et al. (2015): <a href="http://biorxiv.org/content/early/2015/05/04/014043.full-text.pdf+html">NCBI BLAST+ integrated into Galaxy</a></p>

  <p>Cock et al. (2013): <a href="https://peerj.com/articles/167/">Galaxy tools and workflows for sequence analysis with applications in molecular plant pathology</a></p>
</blockquote>

<h2 id="more-similarity-search-tools-in-galaxy">More Similarity Search Tools in Galaxy</h2>

<ul>
  <li>
<strong>VSEARCH</strong>: For processing metagenomic sequences, including searching, clustering, chimera detection, dereplication, sorting, masking and shuffling. VSEARCH stands for vectorized search, as the tool takes advantage of parallelism in the form of SIMD vectorization as well as multiple threads to perform accurate alignments at high speed. VSEARCH uses an optimal global aligner (full dynamic programming Needleman-Wunsch), in contrast to USEARCH which by default uses a heuristic seed and extend aligner. This results in more accurate alignments and overall improved sensitivity (recall) with VSEARCH, especially for alignments with gaps.</li>
</ul>

<blockquote class="tip">
  <h3 id="bulb-tip-2">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip:</h3>

  <p>Documentation for vsearch see <a href="https://github.com/torognes/vsearch">here</a>.</p>
</blockquote>

<ul>
  <li>
<strong>Diamond</strong>: Diamond is a high-throughput program for aligning a file of short reads against a protein reference database such as NR, at 20,000 times the speed of Blastx, with high sensitivity.</li>
</ul>

<blockquote class="tip">
  <h3 id="bulb-tip-3">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip:</h3>

  <p><a href="https://www.nature.com/nmeth/journal/v12/n1/abs/nmeth.3176.html">Buchfink et al. (2015): Fast and sensitive protein alignment using Diamond.</a></p>
</blockquote>

<ul>
  <li>
<strong>Kraken</strong>: Kraken BLAST is a highly scalable, extremely fast, commercial, parallelized implementation of the NCBI BLAST application.</li>
</ul>

<h2 id="identification-of-gene-clusters">Identification of Gene Clusters</h2>

<p>For identification of gene clusters, <strong>antiSMASH</strong> is used. The tool uses genbank file as input files and predicts gene clusters. Output files are a html visualization and the gene cluster proteins.</p>

<blockquote>
  <h3 id="antismash-analysis">antiSMASH analysis</h3>

  <p><img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle"> Import this <a href="../input-data/Streptomyces_coelicolor_part.genbank">dataset</a> into your Galaxy history and run <strong>antiSMASH</strong> to detect gene clusters. The genbank file contains a part of the <em>Streptomyces coelicolor</em> genome sequence.</p>

</blockquote>

<blockquote class="question">
  <h3 id="question-questions-1">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

  <p>Which gene clusters are identified?</p>

  <details>
<summary></summary>
</details>
</blockquote>

<p>When you have a whole genome <strong>antiSMASH</strong> analysis, your result may look like this:</p>

<p><img src="../../images/antismash_full.png" width="80%"></p>

<p>At the end, you can extract a reproducible workflow out of your history. The workflow should look like this:</p>

<p><img src="../../images/work%20flow_Screenshot%20from%202015-06-23%2009-33-23.png" alt="GenomeAnnotation Workflow"></p>


    

    

    <h3>
<img class="emoji" title=":clap:" alt=":clap:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f44f.png" height="20" width="20" align="absmiddle"> Congratulations on successfully completing this tutorial!</h3>


    <hr>
    <blockquote class="overview">
        <h3> <img class="emoji" title=":speech_balloon:" alt=":speech_balloon:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4ac.png" height="20" width="20" align="absmiddle"> Feedback</h3>
        Please take a moment and provide your feedback on this tutorial. Your feedback will help guide and improve future revisions to this tutorial. <a href="https://tinyurl.com/GTNfeedback" target="_blank">Feedback Form</a>
    </blockquote>

    <i>This material is the result of a collaborative work. Thanks to <a href="https://galaxyproject.github.io/training-material//sequence-analysis#contributors">all the contributors</a> and the <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>!<br>
    Found a typo? Something is wrong in this tutorial? Edit it on <a href="https://github.com/galaxyproject/training-material/tree/master/sequence-analysis/tutorials/.md">GitHub</a>.</i>
</section>

        </div>
    </body>
    <script src="https://galaxyproject.github.io/training-material//assets/js/landing_page.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</html>
