<!DOCTYPE html>
<html lang="en">
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Galaxy Training!</title>
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material/assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material/assets/css/main.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material/assets/css/font-awesome.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material/assets/css/syntax_highlighting.css">
    </head>
    <body>
        


<header>
    <nav class="navbar navbar-toggleable-md navbar-inverse">
        <div class="container">
            <a class="navbar-brand" href="https://galaxyproject.github.io/training-material/">
                <img src="https://galaxyproject.github.io/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="https://galaxyproject.github.io/training-material/topics/proteomics" title="Go back to list of tutorials">
                            <i class="fa fa-folder-o"></i> Proteomics
                        </a>
                    </li>

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://galaxyproject.github.io/training-material/topics/proteomics/slides" title="Slides for this tutorial">
                            <i class="fa fa-slideshare"></i> Introduction slides
                        </a>
                    </li>
                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/docker" title="Docker image for this tutorial">
                            <i class="fa fa-ship"></i> Docker image
                        </a>
                    </li>
                    

                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://doi.org/10.5281/zenodo.839701" title="Links to data">
                            <i class="fa fa-files-o"></i> Input Dataset
                        </a>
                    </li>
                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://galaxyproject.github.io/training-material/topics/proteomics#references" title="References">
                            <i class="fa fa-book"></i> Literature
                        </a>
                    </li>
                    

                    <li class="nav-item">
                        <a class="nav-link" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Chat on gitter">
                            <i class="fa fa-life-ring" aria-hidden="true"></i> Help
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/tutorials/metaproteomics/tutorial.md">
                            <i class="fa fa-github"></i> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <section class="tutorial">
        <h1>Metaproteomics tutorial</h1>

        <blockquote class="overview">
            <h3>Overview</h3>

            <p class="bold"> <img class="emoji" title=":grey_question:" alt=":grey_question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2754.png" height="20" width="20" align="absmiddle"> Questions</p>
            <ul>
            
            <li>How can I match metaproteomic mass spectrometry data to peptide sequences derived from shotgun metagenomic data?</li>
            
            <li>How can I perform taxonomy analysis and visualize metaproteomics data?</li>
            
            <li>How can I perform functional analysis on this metaproteomics data?</li>
            
            </ul>

            <p class="bold"> <img class="emoji" title=":dart:" alt=":dart:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f3af.png" height="20" width="20" align="absmiddle"> Objectives</p>
            <ul>
            
            <li>A taxonomy and functional analysis of metaproteomic mass spectrometry data.</li>
            
            </ul>

            
            <p class="bold"> <img class="emoji" title=":heavy_check_mark:" alt=":heavy_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" height="20" width="20" align="absmiddle"> Requirements</p>
            <ul>
            
                <li>
                    
                    <a href="https://galaxyproject.github.io/training-material/topics/introduction/">Galaxy introduction</a>
                    
                </li>
            
            
            </ul>
            

            <p><span class="bold"> <img class="emoji" title=":hourglass:" alt=":hourglass:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/231b.png" height="20" width="20" align="absmiddle"> Time estimation:</span> 2h</p>
        </blockquote>

        <h1 class="no_toc" id="introduction">Introduction</h1>

<p>In this metaproteomics tutorial we will identify expressed proteins from a complex bacterial community sample.
For this MS/MS data will be matched to peptide sequences provided through a FASTA file.</p>

<p>Metaproteomics is the large-scale characterization of the entire protein complement of environmental microbiota
at a given point in time. It has the potential to unravel the mechanistic details of microbial interactions with
the host / environment by analyzing the functional dynamics of the microbiome.</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li>
<a href="#pretreatments" id="markdown-toc-pretreatments">Pretreatments</a>    <ol>
      <li><a href="#data-upload" id="markdown-toc-data-upload">Data upload</a></li>
    </ol>
  </li>
  <li>
<a href="#analysis" id="markdown-toc-analysis">Analysis</a>    <ol>
      <li><a href="#match-peptide-sequences" id="markdown-toc-match-peptide-sequences">Match peptide sequences</a></li>
      <li><a href="#taxonomy-analysis" id="markdown-toc-taxonomy-analysis">Taxonomy analysis</a></li>
      <li><a href="#genus-taxonomy-level-summary" id="markdown-toc-genus-taxonomy-level-summary">Genus taxonomy level summary</a></li>
      <li><a href="#functional-analysis" id="markdown-toc-functional-analysis">Functional Analysis</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 id="pretreatments">Pretreatments</h1>

<h2 id="data-upload">Data upload</h2>

<p>There are a many ways how you can upload your data. Three among these are:</p>

<ul>
  <li>Upload the files from your computer</li>
  <li>Using a direct link</li>
  <li>Import from the data library if your instance provides the files</li>
</ul>

<p>In this tutorial, we will get the data from Zenodo: <a href="https://doi.org/10.5281/zenodo.839701"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.839701.svg" alt="DOI"></a>.</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-data-upload-and-organization">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Data upload and organization</h3>

  <ol>
    <li>Create a new history and name it something meaningful (e.g. <em>Metaproteomics tutorial</em>)</li>
    <li>
      <p>Import the three MGF MS/MS files and the FASTA sequence file from Zenodo.</p>

      <blockquote class="tip">
        <h3 id="bulb-tip-importing-data-via-links">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Importing data via links</h3>

        <ul>
          <li>Copy the link location</li>
          <li>Open the Galaxy Upload Manager</li>
          <li>Select <strong>Paste/Fetch Data</strong>
</li>
          <li>Paste the link into the text field. You can add multiple links, each on a separate line.</li>
          <li>Press <strong>Start</strong>
</li>
        </ul>
      </blockquote>

      <p>As default, Galaxy takes the link as name.</p>

      <blockquote class="comment">
        <h3 id="nut_and_bolt-comments">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comments</h3>
        <ul>
          <li>Rename the datasets to a more descriptive name</li>
        </ul>
      </blockquote>
    </li>
    <li>Build a <strong>Dataset list</strong> for the three MGF files
      <ul>
        <li>Click the <strong>Operations on multiple datasets</strong> check box at the top of the history panel
 <img src="../../images/operations_icon.png" alt="Operations on multiple datasets button">
</li>
        <li>Check the three boxes next to the MGF files</li>
        <li>Click <strong>For all selected…</strong> and choose <strong>Build dataset list</strong>
</li>
        <li>Ensure the three control samples are the only ones selected, and enter a name for the new collection (e.g. <em>MGF files</em>)</li>
        <li>Click <strong>Create list</strong> and exit by clicking again the dataset operations icon</li>
      </ul>
    </li>
  </ol>

</blockquote>

<h1 id="analysis">Analysis</h1>

<h2 id="match-peptide-sequences">Match peptide sequences</h2>

<p>The search database labelled <code class="highlighter-rouge">FASTA_Bering_Strait_Trimmed_metapeptides_cRAP.FASTA</code> is the input database that
will be used to match MS/MS to peptide sequences via a sequence database search.
For this, the sequence database-searching program called <strong>SearchGUI</strong> will be used.
The created dataset collection of the three <em>MGF files</em> in the history is used as the MS/MS input.</p>

<h4 id="searchgui">SearchGUI</h4>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-searchgui">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: SearchGUI</h3>

  <ol>
    <li>
<strong>SearchGUI</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>SearchGUI</strong> with:
      <ul>
        <li>
<strong>Protein Database</strong>: <code class="highlighter-rouge">FASTA_Bering_Strait_Trimmed_metapeptides_cRAP.FASTA</code>(or however you named the <code class="highlighter-rouge">FASTA</code> file)</li>
        <li>
<strong>Input Peak lists (mgf)</strong>: <code class="highlighter-rouge">MGF files</code> dataset collection.</li>
      </ul>

      <blockquote class="tip">
        <h3 id="bulb-tip-select-dataset-collections-as-input">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Select dataset collections as input</h3>

        <ul>
          <li>
            <p>Click the <strong>Dataset collection</strong> icon on the left of the input field:</p>

            <p><img src="../../images/dataset_button.png" alt="Dataset collection button"></p>
          </li>
          <li>
            <p>Select the appropriate dataset collection from the list</p>
          </li>
        </ul>
      </blockquote>

      <p>Section <strong>Search Engine Options</strong>:</p>

      <ul>
        <li>
<strong>B-Search Engines</strong>: <code class="highlighter-rouge">X!Tandem</code>
</li>
      </ul>

      <blockquote class="comment">
        <h3 id="nut_and_bolt-comment">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>

        <p>The section <strong>Search Engine Options</strong> contains a selection of sequence database searching
programs that are available in SearchGUI. Any combination of these programs can be used for
generating PSMs from MS/MS data. For the purpose of this tutorial, <strong>X!Tandem</strong> we will be used.</p>
      </blockquote>

      <p>Section <strong>Protein Digestion Options</strong>:</p>

      <ul>
        <li>
<strong>Digestion</strong>: <code class="highlighter-rouge">Trypsin</code>
</li>
        <li>
<strong>Maximum Missed Cleavages</strong>: <code class="highlighter-rouge">2</code>
</li>
      </ul>

      <p>Section <strong>Precursor Options</strong>:</p>

      <ul>
        <li>
<strong>Precursor Ion Tolerance Units</strong>: <code class="highlighter-rouge">Parts per million (ppm)</code>
</li>
        <li>
<strong>Precursor Ion Tolerance:</strong>: <code class="highlighter-rouge">10</code>
</li>
        <li>
<strong>Fragment Tolerance (Daltons)</strong>: <code class="highlighter-rouge">0.02</code>- this is high resolution MS/MS data</li>
        <li>
<strong>Minimum charge</strong>: <code class="highlighter-rouge">2</code>
</li>
        <li>
<strong>Maximum charge</strong>: <code class="highlighter-rouge">6</code>
</li>
        <li>
<strong>Forward Ion</strong>: <code class="highlighter-rouge">b</code>
</li>
        <li>
<strong>Reverse Ion</strong>: <code class="highlighter-rouge">y</code>
</li>
        <li>
<strong>Minimum Precursor Isotope</strong>: <code class="highlighter-rouge">0</code>
</li>
        <li>
<strong>Maximum Precursor Isotope</strong>: <code class="highlighter-rouge">1</code>
</li>
      </ul>

      <p>Section <strong>Protein Modification Options</strong>:</p>

      <ul>
        <li>
<strong>Fixed Modifications</strong>: <code class="highlighter-rouge">Carbamidomethylation of C</code>
</li>
        <li>
<strong>Variable modifications</strong>: <code class="highlighter-rouge">Oxidation of M</code>
</li>
      </ul>

      <blockquote class="tip">
        <h3 id="bulb-tip-search-for-options">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Search for options</h3>

        <ul>
          <li>For selection lists, typing the first few letters in the window will filter the available options.</li>
        </ul>
      </blockquote>

      <p>Section <strong>Advanced Options</strong>:</p>
      <ul>
        <li>
<strong>X!Tandem Options</strong>: <code class="highlighter-rouge">Advanced</code>
</li>
        <li>
<strong>X!Tandem: Total Peaks</strong>: <code class="highlighter-rouge">50</code>
</li>
        <li>
<strong>X!Tandem: Min Peaks</strong>: <code class="highlighter-rouge">15</code>
</li>
        <li>
<strong>X!Tandem: Min Frag m/z</strong>: <code class="highlighter-rouge">200</code>
</li>
        <li>
<strong>X!Tandem: Min Precursor Mass</strong>: <code class="highlighter-rouge">200</code>
</li>
        <li>
<strong>X!Tandem: Noise Suppression</strong>: <code class="highlighter-rouge">Yes</code>
</li>
        <li>
<strong>X!Tandem: Dynamic Range</strong>: <code class="highlighter-rouge">100</code>
</li>
        <li>
<strong>X!Tandem: Quick Acetyl</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>X!Tandem: Quick Pyrolidone</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>X!Tandem: Protein stP Bias</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>X!Tandem: Maximum Valid Expectation Value</strong>: <code class="highlighter-rouge">100</code>
</li>
        <li>
<strong>X!Tandem: Output Proteins</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>X!Tandem: Output Sequences</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>X!Tandem: Output Spectra</strong>: <code class="highlighter-rouge">Yes</code>
</li>
        <li>
<strong>X!Tandem peptide model refinement</strong>: <code class="highlighter-rouge">Don't refine</code>
</li>
        <li>leave everything else as default</li>
      </ul>
    </li>
    <li>Click <strong>Execute</strong>.</li>
  </ol>

</blockquote>

<p>Once the database search is completed, the SearchGUI tool will output a file (called a
SearchGUI archive file) that will serve as an input for the next section, PeptideShaker.</p>

<blockquote class="comment">
  <h3 id="nut_and_bolt-comment-1">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>
  <p>In order to maintain accuracy and effectiveness in spectral / peptide / protein identification, a
target-decoy search strategy can be used to discern how correct and incorrect a spectral or
peptide or protein match is. The most popular approach for generating decoy databases is the
<em>reverse database</em> approach. Essentially, protein sequences are reversed to generate a <em>decoy</em>
database. Any matches and their associated scores against a target and decoy database are
noted (with the premise that matches against decoy matches are incorrect). Later the matches
are ranked according to descending scores and <em>decoy matches</em> are used to calculate false
discovery rate (FDR) to set a threshold for valid identifications. The FDR approach allows for a
fairer comparison of datasets across labs, machines and proteomic workflows. Please read
the manuscript by Elias and Gygi (2010) for more information.</p>

</blockquote>

<h4 id="peptideshaker">PeptideShaker</h4>

<p><strong>PeptideShaker</strong> is a post-processing software tool that
processes data from the SearchGUI software tool. It serves to organize the Peptide-Spectral
Matches (PSMs) generated from SearchGUI processing and is contained in the SearchGUI archive.
It provides an assessment of confidence of the data, inferring proteins identified from the
matched peptide sequences and generates outputs that can be visualized by users to interpret
results. PeptideShaker has been wrapped in Galaxy to work in combination with SearchGUI
outputs.</p>

<blockquote class="comment">
  <h3 id="nut_and_bolt-comment-2">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>
  <p>There are a number of choices for different data files that can be generated using
PeptideShaker. A compressed file can be made containing all information needed to view the
results in the standalone PeptideShaker viewer. A <code class="highlighter-rouge">mzidentML</code> file can be created that contains
all peptide sequence matching information and can be utilized by compatible downstream
software. Other outputs are focused on the inferred proteins identified from the PSMs, as well
as phosphorylation reports, relevant if a phosphoproteomics experiment has been undertaken.</p>
</blockquote>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-peptideshaker">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: PeptideShaker</h3>

  <ol>
    <li>
<strong>PeptideShaker</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>PeptideShaker</strong> with:
      <ul>
        <li>
<strong>Compressed SearchGUI results</strong>: The SearchGUI archive file</li>
        <li>
<strong>Specify Advanced PeptideShaker Processing Options</strong>: <code class="highlighter-rouge">Default Processing Options</code>
</li>
        <li>
<strong>Specify Advanced Filtering Options</strong>: <code class="highlighter-rouge">Default Filtering Options</code>
</li>
        <li>
<strong>Specify Contact Information for mzIdendML</strong>: You can leave the default dummy options for now, but feel free to enter custom contact information.</li>
        <li>
<strong>Include the protein sequences in mzIdentML</strong>: <code class="highlighter-rouge">No</code>
</li>
        <li>
<strong>Output options</strong>: Select the <code class="highlighter-rouge">PSM Report</code> (Peptide-Spectral Match) and the <code class="highlighter-rouge">Certificate of Analysis</code>
</li>
      </ul>

      <blockquote class="comment">
        <h3 id="nut_and_bolt-comment-3">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>

        <p>The <strong>Certificate of Analysis</strong> provides details on all the parameters
used by both SearchGUI and PeptideShaker in the analysis. This can be downloaded from the
Galaxy instance to your local computer in a text file if desired.</p>
      </blockquote>
    </li>
    <li>Click <strong>Execute</strong> and inspect the resulting files after they turned green with the <strong>View data</strong> icon:
 <img src="../../images/view_data_icon.png" alt="View data button">
</li>
  </ol>

</blockquote>

<p>A number of new items will appear in your history, each corresponding to the outputs selected
in the PeptideShaker parameters. Most relevant for this tutorial is the PSM report:</p>

<figure id="figure-1"><img src="../../images/psm_report.png" alt="Display of the PSM report tabular file" title="The PSM report"><figcaption><span class="figcaption-prefix">Figure 1:</span> The PSM report</figcaption></figure>

<p>Scrolling at the bottom to the left will show the sequence for the PSM that matched to these
metapeptide entries. Column 3 is the sequence matched for each PSM entry. Every PSM is a
new row in the tabular output.</p>

<p>In the following steps of this tutorial, selected portions of this output will be extracted and used for
analysis of the taxonomic make-up of the sample as well as the biochemical functions
represented by the proteins identified.</p>

<h2 id="taxonomy-analysis">Taxonomy analysis</h2>

<p>In the previous section, the genome sequencing and mass spectrometry data from
processing of biological samples was used to identify peptides present in those samples.
Now those peptides are used as evidence to infer which organisms are represented in the sample,
and what biological functions those peptides and associated proteins suggest are occurring.</p>

<p>The UniProt organization collects and annotates all known proteins for organisms. A UniProt
entry includes the protein amino acid sequence, the NCBI taxonomy, and any annotations
about structure and function of the protein. The UniPept web resource developed
by Ghent University will be used to match the sample peptides to proteins. UniPept indexes all Uniprot
proteins and provides a fast matching algorithm for peptides.</p>

<blockquote class="tip">
  <h3 id="bulb-tip-unipept">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Unipept</h3>

  <p>Users can access UniPept via a <a href="https://unipept.ugent.be">web page</a> and paste peptide
sequences into the search form to retrieve protein information. But we`ll use a Galaxy
<em>Unipept</em> tool to automate the process. The <em>Unipept</em> tool sends the peptide list to the
UniPept REST API service, then transforms the results into datasets that can be further analyzed
or operated on within Galaxy.</p>
</blockquote>

<h4 id="recieving-the-list-of-peptides-query-tabular">Recieving the list of peptides: Query Tabular</h4>

<p>In order to use <em>Unipept</em>, a list containing the peptide sequences has to be generated.
The tool <strong>Query Tabular</strong> can load tabular data (the PSM report in this case) into a SQLite data base.
As a tabular file is being read, line filters may be applied and an SQL query can be performed.</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-query-tabular">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Query Tabular</h3>

  <ol>
    <li>
      <p><strong>Query Tabular</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Query Tabular</strong> with:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>:</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The PSM report</li>
      </ul>

      <p>Section <strong>Filter Dataset Input</strong>:</p>

      <ul>
        <li>
<strong>Filter Tabular Input Lines</strong>: Click on <code class="highlighter-rouge">+ Insert Filter Tabular Input Lines</code>:</li>
        <li>
<strong>Filter By</strong>: Select <code class="highlighter-rouge">by regex expression matching</code>
          <ul>
            <li>
<strong>regex pattern</strong>: <code class="highlighter-rouge">^\d</code>
</li>
            <li>
<strong>action for regex match</strong>: <code class="highlighter-rouge">include line on pattern match</code>
</li>
          </ul>
        </li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">psm</code>
</li>
        <li>
          <p><strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">id,,sequence,,,,,,,,,,,,,,,,,,,,confidence,validation</code></p>

          <blockquote class="comment">
            <h3 id="nut_and_bolt-comment-4">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>

            <p>By default, table columns will be named: c1,c2,c3,…,cn (column names for a table must be unique).
You can override the default names by entering a comma separated list of names, e.g. <code class="highlighter-rouge">,name1,,,name2</code>
would rename the second and fifth columns.</p>

            <p>Check your input file to find the settings which best fits your needs.</p>
          </blockquote>
        </li>
        <li>
          <p><strong>Only load the columns you have named into database</strong>: <code class="highlighter-rouge">Yes</code></p>
        </li>
        <li>
          <p><strong>Save the sqlite database in your history</strong>: <code class="highlighter-rouge">Yes</code></p>

          <blockquote class="tip">
            <h3 id="bulb-tip">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip</h3>

            <ul>
              <li>
<strong>Query Tabular</strong> can also use an existing SQLite database. Activating <code class="highlighter-rouge">Save the sqlite database in your history</code>
will store the created database in the history, allowing to reuse it directly.</li>
            </ul>

          </blockquote>
        </li>
        <li>
          <p><strong>SQL Query to generate tabular output</strong>:</p>

          <div class="highlighter-rouge">
<pre class="highlight"><code>SELECT distinct sequence
    
FROM psm

WHERE validation IS NOT 'Confident' AND confidence &gt;= 95
     
ORDER BY sequence
</code></pre>
          </div>
        </li>
      </ul>

      <blockquote class="question">
        <h3 id="question-questions">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <p>The SQL query might look confusing at first, but having a closer look should clarify a lot.</p>

        <ol>
          <li>What does <code class="highlighter-rouge">FROM psm</code> mean?</li>
          <li>
            <p>What need to be changed if we only want peptides with a confidence higher then 98%?</p>

            <details>
<summary>Click to view answers</summary>
<ol type="1">
<li>We want to read from table "psm". We defined the name before in the "Specify Name for Table" option.</li>
<li>We need to change the value in line 3: "WHERE validation IS NOT 'Confident' AND confidence &gt;= 98"</li>
</ol>
</details>
          </li>
        </ol>
      </blockquote>

      <ul>
        <li>
<strong>Omit column headers from tabular output</strong>: <code class="highlighter-rouge">Yes</code>
</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong> and inspect the query results file after it turned green. If everything went well, it should look similiar:</p>

      <figure id="figure-2"><img src="../../images/query_tabular_1.png" alt="Query Tabular output showing the peptides" title="Query Tabular output"><figcaption><span class="figcaption-prefix">Figure 2:</span> Query Tabular output</figcaption></figure>
    </li>
  </ol>

</blockquote>

<p>While we can proceed with this list of peptides, let’s practice using the created SQLite database for further queries.
We might not only be interested in all the distinct peptides, but also on how many PSMs a single peptide had.
Therefore we can search the database for the peptides and count the occurrence without configuring the tables and columns again:</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-sqlite-to-tabular">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: SQLite to tabular</h3>

  <ol>
    <li>
      <p><strong>SQLite to tabular</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>SQLite to tabular</strong> with:</p>

      <ul>
        <li>
          <p><strong>SQL Query</strong>:</p>

          <div class="highlighter-rouge">
<pre class="highlight"><code>SELECT sequence as "peptide", count(id) as "PSMs" 
    
FROM psm

WHERE validation IS NOT 'Confident' AND confidence &gt;= 95
     
GROUP BY sequence

ORDER BY sequence
</code></pre>
          </div>
        </li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong>. The resulting file should have two columns, one with the distinct peptides, the other with the count number of PSMs.</p>
    </li>
  </ol>

</blockquote>

<h4 id="retrieve-taxonomy-for-peptides-unipept">Retrieve taxonomy for peptides: Unipept</h4>

<p>The generated list of peptides can now be used to search via <em>Unipept</em>.
We do a taxonomy analysis using the UniPept pept2lca function to return the taxonomic lowest common ancestor for each peptide:</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-unipept">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Unipept</h3>

  <ol>
    <li>
      <p><strong>Unipept</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Unipept</strong> with:</p>

      <ul>
        <li>
<strong>Unipept application</strong>: <code class="highlighter-rouge">pept2lca: lowest common ancestor</code>
</li>
        <li>
<strong>Peptides input format</strong>: <code class="highlighter-rouge">tabular</code>
</li>
        <li>
<strong>Tabular Input Containing Peptide column</strong>: The query results file.</li>
        <li>
<strong>Select column with peptides</strong>: <code class="highlighter-rouge">Column 1</code>
</li>
        <li>
<strong>Choose outputs</strong>: Select <code class="highlighter-rouge">tabular</code> and <code class="highlighter-rouge">JSON taxonomy tree</code>
</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong>. The history should grow by two files. View each to see the difference.</p>

      <blockquote class="comment">
        <h3 id="nut_and_bolt-comment-5">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comment</h3>

        <p>The JSON (JavaScript Object Notation) file contains the same information as the tabular file but is not comfortably human readable. 
Instead, we can use it to use JavaScript libraries to visualize this data.</p>
      </blockquote>
    </li>
    <li>
      <p>Visualize the data:</p>

      <ul>
        <li>
          <p>Click on the JSON output file from the <em>Unipept</em> tool to expand it. Click on the <strong>Visualize</strong> button and select <strong>Unipept Tree viewer</strong>:</p>

          <p><img src="../../images/visualize_button.png" alt="Visualize button"></p>
        </li>
        <li>
          <p>A new window should appear with a visualization of the taxonomy tree of your data. Use the mouse wheel to scroll in and out and click on nodes to expand or collapse them:</p>

          <figure id="figure-3"><img src="../../images/unipept_tree_viewer.png" alt="Unipept Tree viewer visual output" title="Interactive visualization from the Unipept Tree viever plugin"><figcaption><span class="figcaption-prefix">Figure 3:</span> Interactive visualization from the Unipept Tree viever plugin</figcaption></figure>
        </li>
      </ul>
    </li>
  </ol>

</blockquote>

<h2 id="genus-taxonomy-level-summary">Genus taxonomy level summary</h2>

<p>The tabular <em>Unipept</em> output lists the taxonomy assignments for each peptide. To create a meaningful summary, the <strong>Query Tabular</strong> tool is
once again used, aggregating the number of peptides and PSMs for each genus level taxonomy assignment:</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-query-tabular-1">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Query Tabular</h3>

  <ol>
    <li>
      <p><strong>Query Tabular</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Query Tabular</strong> with:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>
</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The PSM report</li>
      </ul>

      <p>Section <strong>Filter Dataset Input</strong>:</p>

      <ul>
        <li>
<strong>Filter Tabular Input Lines</strong>: Click on <code class="highlighter-rouge">+ Insert Filter Tabular Input Lines</code>:</li>
        <li>
<strong>Filter By</strong>: Select <code class="highlighter-rouge">by regex expression matching</code>
          <ul>
            <li>
<strong>regex pattern</strong>: <code class="highlighter-rouge">^\d</code>
</li>
            <li>
<strong>action for regex match</strong>: <code class="highlighter-rouge">include line on pattern match</code>
</li>
          </ul>
        </li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">psm</code>
</li>
        <li>
          <p><strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">,,sequence,,,,,,,,,,,,,,,,,,,,confidence,validation</code></p>
        </li>
        <li>
<strong>Only load the columns you have named into database</strong>: <code class="highlighter-rouge">Yes</code>
</li>
      </ul>
    </li>
    <li>
      <p>Repeat this step to have a second <strong>Database Table</strong>:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>
</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The <strong>Unipept</strong> <code class="highlighter-rouge">tabular</code>/<code class="highlighter-rouge">tsv</code> output</li>
      </ul>

      <p>Section <strong>Filter Dataset Input</strong>:</p>

      <ul>
        <li>
<strong>Filter Tabular Input Lines</strong>: Click on <code class="highlighter-rouge">+ Insert Filter Tabular Input Lines</code>:</li>
        <li>
<strong>Filter By</strong>: Select <code class="highlighter-rouge">by regex expression matching</code>
          <ul>
            <li>
<strong>regex pattern</strong>: <code class="highlighter-rouge">#peptide</code>
</li>
            <li>
<strong>action for regex match</strong>: <code class="highlighter-rouge">exclude line on pattern match</code>
</li>
          </ul>
        </li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">lca</code>
</li>
        <li>
          <p><strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">peptide,,,,,,,,,,,,,,,,,,,,,genus</code></p>
        </li>
        <li>
          <p><strong>Only load the columns you have named into database</strong>: <code class="highlighter-rouge">Yes</code></p>
        </li>
        <li>
          <p><strong>Save the sqlite database in your history</strong>: <code class="highlighter-rouge">No</code></p>
        </li>
        <li>
          <p><strong>SQL Query to generate tabular output</strong>:</p>

          <div class="highlighter-rouge">
<pre class="highlight"><code>SELECT lca.genus,count(psm.sequence) as "PSMs",count(distinct psm.sequence) as "DISTINCT PEPTIDES" 
    
FROM psm LEFT JOIN lca ON psm.sequence = lca.peptide 

WHERE validation IS NOT 'Confident' AND confidence &gt;= 95
     
GROUP BY lca.genus

ORDER BY PSMs desc, 'DISTINCT PEPTIDES' desc
</code></pre>
          </div>
        </li>
        <li>
<strong>Omit column headers from tabular output</strong>: <code class="highlighter-rouge">No</code>
</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong> and inspect the query results file after it turned green:</p>

      <figure id="figure-4"><img src="../../images/metaproteomics_summary.png" alt="Query Tabular output showing gene, PSMs and distinct peptides" title="Query Tabular output"><figcaption><span class="figcaption-prefix">Figure 4:</span> Query Tabular output</figcaption></figure>
    </li>
  </ol>

</blockquote>

<h2 id="functional-analysis">Functional Analysis</h2>

<p>In the following chapter, a functional analysis will be performed in order to match the list of peptides with the correlated Gene Ontology terms.
This allows to get an insight of the <strong>biological process</strong>, the <strong>molecular function</strong> and the <strong>cellular component</strong> related to the sample data.</p>

<blockquote class="comment">
  <h3 id="nut_and_bolt-gene-ontology-consortium">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Gene Ontology Consortium</h3>

  <p>The <a href="http://www.geneontology.org/">Gene Ontology Consortium</a> provides with its Ontology a framework for the model of biology.
The GO defines concepts/classes used to describe gene function, and relationships between these concepts. It classifies functions along three aspects:</p>

  <ul>
    <li>
      <p><strong>molecular function</strong></p>

      <ul>
        <li>molecular activities of gene products</li>
      </ul>
    </li>
    <li>
      <p><strong>cellular component</strong></p>

      <ul>
        <li>where gene products are active</li>
      </ul>
    </li>
    <li>
      <p><strong>biological process</strong></p>

      <ul>
        <li>pathways and larger processes made up of the activities of multiple gene products.</li>
      </ul>
    </li>
  </ul>

  <p><a href="http://geneontology.org/page/ontology-documentation">more information</a></p>

</blockquote>

<h4 id="data-upload-1">Data upload</h4>

<p>For this tutorial, a tabular file containing the relevant GO terms has been created. It contains the GO aspect, the ID and the name.
It is available at Zenodo: <a href="https://doi.org/10.5281/zenodo.839701"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.839701.svg" alt="DOI"></a>.</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-data-upload">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Data upload</h3>

  <ol>
    <li>
      <p>Import the file <code class="highlighter-rouge">Gene_Ontology_Terms.tabular</code> from Zenodo.</p>

      <blockquote class="tip">
        <h3 id="bulb-tip-setting-file-metadata-on-upload">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Setting file metadata on upload</h3>

        <p>In the upload window of Galaxy you can set the filetype and related genome of the file you’re uploading in the corresponding columns beforehand.
This might be handy if the automatic detection of the filetype didn’t work out perfectly or if you want to avoid setting the genome later on, especially for multiple files.</p>

      </blockquote>

      <p>As default, Galaxy takes the link as name.</p>

      <blockquote class="comment">
        <h3 id="nut_and_bolt-comments-1">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> Comments</h3>
        <ul>
          <li>Rename the datasets to a more descriptive name, e.g. <code class="highlighter-rouge">Gene Ontology Terms</code>
</li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<blockquote class="tip">
  <h3 id="bulb-tip-creating-your-own-gene-ontology-list">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Creating your own Gene Ontology list</h3>

  <p>The latest Gene Ontology can be downloaded <a href="http://geneontology.org/page/download-ontology">here</a> as a text file in the <code class="highlighter-rouge">OBO</code> format.
<code class="highlighter-rouge">OBO</code> files are human-readable (in addition to machine-readable) and can be opened in any text editor. They contain more information than just the name and aspect.</p>

  <p>In order to receive a file like we use in the tutorial for your own analysis, different tools are available to extract information from <code class="highlighter-rouge">OBO</code> files,
one of them being <a href="https://www.ncbi.nlm.nih.gov/labs/articles/18245124/">ONTO-PERL</a>.
An example file with all GO terms from 08.07.2017 named <code class="highlighter-rouge">Gene_Ontology_Terms_full_07.08.2017.tabular</code> can be found on the <a href="https://doi.org/10.5281/zenodo.839701">Zenodo repository</a> of this tutorial as well.</p>

</blockquote>

<h4 id="retrieve-go-ids-for-peptides-unipept">Retrieve GO IDs for peptides: Unipept</h4>

<p>The <strong>UniPept</strong> application <code class="highlighter-rouge">pept2prot</code> can be used to receive the GO identifiers connected to the list of peptides that was generated from the Peptide Shaker result:</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-unipept-1">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Unipept</h3>

  <ol>
    <li>
      <p><strong>Unipept</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Unipept</strong> with:</p>

      <ul>
        <li>
<strong>Unipept application</strong>: <code class="highlighter-rouge">pept2prot: UniProt entries containing a given tryptic peptide</code>
</li>
        <li>
<strong>retrieve extra information</strong>: <code class="highlighter-rouge">Yes</code>
</li>
        <li>
<strong>Peptides input format</strong>: <code class="highlighter-rouge">tabular</code>
</li>
        <li>
<strong>Tabular Input Containing Peptide column</strong>: The first query results file.</li>
        <li>
<strong>Select column with peptides</strong>: <code class="highlighter-rouge">Column 1</code>
</li>
        <li>
<strong>Choose outputs</strong>: Select <code class="highlighter-rouge">tabular</code>
</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong>.</p>
    </li>
    <li>
      <p>inspect the result:</p>

      <ul>
        <li>The output should be a tabular file containing a column labeled <code class="highlighter-rouge">go_references</code>. This is what we’re looking for.</li>
      </ul>
    </li>
  </ol>

</blockquote>

<h4 id="normalizing-a-table-split-tabular-columns">Normalizing a table: Split Tabular Columns</h4>

<p>The UniPept result file can contain multiple GO IDs in a single row. In order to create a normalized table of this data, these rows will be split so each record contains only one GO ID using the <strong>Split Tabular Columns</strong> tool:</p>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-split-tabular-columns">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Split Tabular Columns</h3>

  <ol>
    <li>
      <p><strong>Split Tabular Columns</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Split Tabular Columns</strong> with:</p>

      <ul>
        <li>
<strong>Tabular Dataset to normalize</strong>: The latest UniPept <code class="highlighter-rouge">tabluar</code>/<code class="highlighter-rouge">tsv</code> output</li>
        <li>
<strong>Columns to split</strong>: Select <code class="highlighter-rouge">Column: 6</code>, the one containing the GO IDs</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong>.</p>
    </li>
    <li>
      <p>inspect the result:</p>

      <ul>
        <li>The column labeled <code class="highlighter-rouge">go_references</code> should now contain only no or one entry.</li>
      </ul>
    </li>
  </ol>

</blockquote>

<h4 id="combine-all-information-to-quantify-the-go-results">Combine all information to quantify the GO results</h4>

<p>As a final step we will use <strong>Query Tabular</strong> in a more sophisticated way to combine all information to quantify the GO analysis. The three used file and the extracted information are:</p>

<ul>
  <li>
<strong>Gene Ontology Terms</strong>:
    <ul>
      <li>
<code class="highlighter-rouge">go_id</code> to match with <strong>Normalized UniPept output</strong>
</li>
      <li>The GO <code class="highlighter-rouge">aspect</code> to group the results in three separate files</li>
      <li>The GO <code class="highlighter-rouge">description</code> to annotate the results</li>
    </ul>
  </li>
  <li>
<strong>Normalized UniPept output</strong>:
    <ul>
      <li>
<code class="highlighter-rouge">peptide</code> to match with <strong>PSM Report</strong> and to count distinct peptides per GO term</li>
      <li>
<code class="highlighter-rouge">go_reference</code> to match with <strong>Gene Ontology Terms</strong>
</li>
    </ul>
  </li>
  <li>
<strong>PSM Report</strong>:
    <ul>
      <li>
<code class="highlighter-rouge">sequence</code> to match with <strong>Normalized UniPept output</strong>
</li>
      <li>
<code class="highlighter-rouge">id</code> to count distinct PSM’s per GO term</li>
    </ul>
  </li>
</ul>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-query-tabular-2">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Query Tabular</h3>

  <ol>
    <li>
      <p><strong>Query Tabular</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Run <strong>Query Tabular</strong> with:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>
</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The <code class="highlighter-rouge">Gene Ontology Terms</code> file</li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">go</code>
</li>
        <li>
<strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">aspect,go_id,description</code>
</li>
      </ul>
    </li>
    <li>
      <p>Repeat this step to have a second <strong>Database Table</strong>:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>
</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The <strong>Unipept</strong> normalized <code class="highlighter-rouge">tabluar</code>/<code class="highlighter-rouge">tsv</code> output</li>
      </ul>

      <p>Section <strong>Filter Dataset Input</strong>:</p>

      <ul>
        <li>
<strong>Filter Tabular Input Lines</strong>: Click on <code class="highlighter-rouge">+ Insert Filter Tabular Input Lines</code>:</li>
        <li>
<strong>Filter By</strong>: Select <code class="highlighter-rouge">comment char</code>
          <ul>
            <li>
<strong>Ignore lines beginning with these characters</strong>: Select <code class="highlighter-rouge">#</code>
</li>
          </ul>
        </li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">bering</code>
</li>
        <li>
<strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">peptide,uniprot_id,taxon_id,taxon_name, ec_references,go_reference,refseq_ids,refseq_protein_ids,insdc_ids,insdc_protein_ids</code>
</li>
      </ul>
    </li>
    <li>
      <p>Repeat this step to have a third <strong>Database Table</strong>:</p>

      <ul>
        <li>
<strong>Database Table</strong>: Click on <code class="highlighter-rouge">+ Insert Database Table</code>
</li>
        <li>
<strong>Tabular Dataset for Table</strong>: The <code class="highlighter-rouge">PSM Report</code>
</li>
      </ul>

      <p>Section <strong>Filter Dataset Input</strong>:</p>

      <ul>
        <li>
<strong>Filter Tabular Input Lines</strong>: Click on <code class="highlighter-rouge">+ Insert Filter Tabular Input Lines</code>:</li>
        <li>
<strong>Filter By</strong>: Select <code class="highlighter-rouge">by regex expression matching</code>
          <ul>
            <li>
<strong>regex pattern</strong>: <code class="highlighter-rouge">^\d</code>
</li>
            <li>
<strong>action for regex match</strong>: <code class="highlighter-rouge">include line on pattern match</code>
</li>
          </ul>
        </li>
      </ul>

      <p>Section <strong>Table Options</strong>:</p>

      <ul>
        <li>
<strong>Specify Name for Table</strong>: <code class="highlighter-rouge">bering_psms</code>
</li>
        <li>
          <p><strong>Specify Column Names (comma-separated list)</strong>: <code class="highlighter-rouge">id,,sequence,,,,,,,,,,,,,,,,,,,,confidence,validation</code></p>
        </li>
        <li>
          <p><strong>Save the sqlite database in your history</strong>: <code class="highlighter-rouge">Yes</code></p>
        </li>
        <li>
          <p><strong>SQL Query to generate tabular output</strong>:</p>

          <div class="highlighter-rouge">
<pre class="highlight"><code>SELECT g.description, count(distinct b.peptide) as "bering_peptides", count(distinct b.id) as "bering_psms"
    
FROM go as g JOIN

( SELECT go.description, bering.peptide, bering_psms.id
     
FROM go LEFT OUTER JOIN bering ON go.go_id = bering.go_reference JOIN bering_psms ON bering.peptide = bering_psms.sequence

GROUP BY go.description, bering.peptide, bering_psms.id

) as b ON g.description = b.description

WHERE g.aspect = 'biological_process'

GROUP BY g.description

ORDER BY  bering_peptides desc,bering_psms desc
</code></pre>
          </div>
        </li>
        <li>
<strong>Omit column headers from tabular output</strong>: <code class="highlighter-rouge">No</code>
</li>
      </ul>
    </li>
    <li>
      <p>Click <strong>Execute</strong> and inspect the three query result files.</p>
    </li>
  </ol>

</blockquote>

<p>With these three resulting files the functional analysis of this tutorial is finished. Each record contains the name of a GO term, the amount of peptides
related to it and the amount of PSMs for these peptides.</p>

<blockquote class="comment">
  <h3 id="nut_and_bolt-references">
<img class="emoji" title=":nut_and_bolt:" alt=":nut_and_bolt:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f529.png" height="20" width="20" align="absmiddle"> References</h3>

  <ul>
    <li>
      <p><a href="https://www.ncbi.nlm.nih.gov/pubmed/27824341">Dataset</a> and <a href="https://www.ncbi.nlm.nih.gov/pubmed/27396978">SixGill software</a></p>
    </li>
    <li>
      <p><a href="https://www.ncbi.nlm.nih.gov/pubmed/26058579">Galaxy workflows for metaproteomics</a></p>
    </li>
    <li>
      <p><a href="https://z.umn.edu/gcc2017mporal">Metaproteomics community effort</a></p>
    </li>
  </ul>

</blockquote>


        
        <blockquote class="key_points">
            <h3> <img class="emoji" title=":grey_exclamation:" alt=":grey_exclamation:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2755.png" height="20" width="20" align="absmiddle"> Key points</h3>

            <ul>
            
            <li>Use dataset collections</li>
            
            <li>With SearchGUI and PeptideShaker you can gain access to multiple search engines</li>
            
            <li>Learning the basics of SQL queries can pay off</li>
            
            </ul>
        </blockquote>
        

        
        <h1>Useful literature</h1>
        <p>Useful information regarding this type of analysis with descriptions and paper references for the tools used in this tutorial, and literature for this analysis techniques and interpretations can be found <a href="https://galaxyproject.github.io/training-material/topics/proteomics#references">here</a>.</p>
        

        <h3>
<img class="emoji" title=":clap:" alt=":clap:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f44f.png" height="20" width="20" align="absmiddle"> Congratulations on successfully completing this tutorial!</h3>


        <hr>
        <blockquote class="overview">
            <h3> <img class="emoji" title=":speech_balloon:" alt=":speech_balloon:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4ac.png" height="20" width="20" align="absmiddle"> Feedback</h3>
            Please take a moment and provide your feedback on this tutorial. Your feedback will help guide and improve future revisions to this tutorial. <a href="https://tinyurl.com/GTNfeedback" target="_blank">Feedback Form</a>
        </blockquote>

            </section>
</div>

<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the contributors
            
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/tutorials/metaproteomics/tutorial.md">GitHub</a>.
        </p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="https://galaxyproject.github.io/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="https://galaxyproject.github.io/training-material/assets/js/tether.min.js"></script>
    <script type="text/javascript" src="https://galaxyproject.github.io/training-material/assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://galaxyproject.github.io/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</html>
