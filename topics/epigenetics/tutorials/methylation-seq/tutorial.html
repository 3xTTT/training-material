<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Galaxy Training!</title>
        <link media="all" href="https://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/landing_page.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/tutorial.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/font-awesome.css">
        <link rel="stylesheet" href="https://galaxyproject.github.io/training-material//assets/css/syntax_highlighting.css">
        <meta name="viewport" content="width=device-width">
    </head>
    <body>
        <div class="wrapper">
            


<header>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a id="site-title" class="navbar-brand" href="https://wiki.galaxyproject.org/Teach/GTN">
              <img class="pull-left img-responsive" src="https://galaxyproject.github.io/training-material///assets/images/GTN.png">
            </a>
            <a id="site-title" class="navbar-brand name-holder" href="https://galaxyproject.github.io/training-material//topics/epigenetics/tutorials/methylation-seq/tutorial.html">
              DNA Methylation data analysis
            </a>
          </div>

          <div class="collapse navbar-collapse" id="navbar">

            <ul id="main-menu" class="nav navbar-nav navbar-right">
              <li><a href="https://galaxyproject.github.io/training-material/" title="Back to front page"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="https://galaxyproject.github.io/training-material//topics/epigenetics" title="Go back to list of tutorials"><i class="fa fa-file-text-o"></i> Epigenetics</a></li>

              
                <li><a href="https://galaxyproject.github.io/training-material//topics/epigenetics/slides" title="Slides for this tutorial"><i class="fa fa-graduation-cap"></i> Introduction slides</a></li>
              
              <!--<li><a href="https://galaxyproject.github.io/training-material//epigenetics/slides/methylation-seq/"><i class="fa fa-file-powerpoint-o"></i> Associated slides</a></li>-->

              
                <li><a href="https://github.com/galaxyproject/training-material/tree/master/topics/epigenetics/docker" title="Docker image for this tutorial"><i class="fa fa-ship"></i> Docker image</a></li>
              

              

              
                <li><a href="https://zenodo.org/record/557099" title="Links to data"><i class="fa fa-folder-open"></i> Input Dataset</a></li>
              

              
                <li><a href="https://galaxyproject.github.io/training-material//topics/epigenetics#references" title="References"><i class="fa fa-book"></i> Literature</a></li>
              

            </ul>
          </div>
        </div>
    </nav>
</header>

<section class="tutorial">
    <h1>DNA Methylation data analysis</h1>

    <blockquote class="overview">
        <h3>Overview</h3>

        <p class="bold"> <img class="emoji" title=":grey_question:" alt=":grey_question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2754.png" height="20" width="20" align="absmiddle"> Questions</p>
        <ul>
        
          <li>What is methylation and why it cannot be recognised by a normal NGS procedure?</li>
        
          <li>Can a different methylation influence the expression of a gene? How?</li>
        
          <li>Which tools you can use to analyse methylation data?</li>
        
        </ul>

        <p class="bold"> <img class="emoji" title=":dart:" alt=":dart:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f3af.png" height="20" width="20" align="absmiddle"> Objectives</p>
        <ul>
        
          <li>Learn how to analyse methylation data</li>
        
          <li>Get a first intuition what are common pitfalls.</li>
        
        </ul>

        
        <p class="bold"> <img class="emoji" title=":heavy_check_mark:" alt=":heavy_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2714.png" height="20" width="20" align="absmiddle"> Requirements</p>
        <ul>
          
            <li>
                
                <a href="https://galaxyproject.github.io/training-material//topics//introduction/">Galaxy introduction</a>
                
            </li>
          
            <li>
                
                <a href="https://galaxyproject.github.io/training-material//topics//sequence-analysis/">Quality control</a>
                
            </li>
          
            <li>
                
                <a href="https://galaxyproject.github.io/training-material//topics//sequence-analysis/">Mapping</a>
                
            </li>
          
          
        </ul>
        

        <p><span class="bold"> <img class="emoji" title=":hourglass:" alt=":hourglass:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/231b.png" height="20" width="20" align="absmiddle"> Time estimation:</span> 3h</p>

    </blockquote>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#load-data-and-quality-control" id="markdown-toc-load-data-and-quality-control">Load data and quality control</a></li>
  <li><a href="#alignment" id="markdown-toc-alignment">Alignment</a></li>
  <li><a href="#methylation-bias-and-metric-extraction" id="markdown-toc-methylation-bias-and-metric-extraction">Methylation bias and metric extraction</a></li>
  <li><a href="#visualization" id="markdown-toc-visualization">Visualization</a></li>
  <li><a href="#metilene" id="markdown-toc-metilene">Metilene</a></li>
</ol>

</blockquote>

<p>This tutorial is based on <a href="https://dx.doi.org/10.1371/journal.pone.0118453">I-Hsuan Lin et al.: ‘Hierarchical Clustering of Breast Cancer Methylomes Revealed Differentially Methylated and Expressed Breast Cancer Genes’</a>.</p>

<p>The data we use in this tutorial is available at <a href="https://zenodo.org/record/557099">Zenodo</a>.</p>

<h1 id="load-data-and-quality-control">Load data and quality control</h1>
<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-get-the-data-and-look-at-the-quality">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Get the data and look at the quality</h3>

  <p>We load now the example dataset which will be used for the tutorial.</p>

  <ol>
    <li>
      <p>Load the two example datasets from our data library: subset_1.fastq.gz and subset_2.fastq.gz.</p>

      <blockquote class="tip">
        <h3 id="bulb-tip-get-data-from-the-library">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Get data from the library</h3>

        <ul>
          <li>Click on <code class="highlighter-rouge">Shared Data</code> –&gt; <code class="highlighter-rouge">Data Libraries</code> and here <code class="highlighter-rouge">MethylSeq_2017</code>
</li>
          <li>Select the uploaded datasets <code class="highlighter-rouge">subset_1.fastq.gz</code> and <code class="highlighter-rouge">subset_2.fastq.gz</code> as the fastq files</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p><strong>FastQC</strong></p>

      <blockquote class="tip">
        <h3 id="bulb-tip-search-for-tools">
<img class="emoji" title=":bulb:" alt=":bulb:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" align="absmiddle"> Tip: Search for tools</h3>

        <ul>
          <li>Click into the search field on the left</li>
          <li>Type <strong>fastqc</strong>
</li>
          <li>Select <strong>FastQC</strong>
</li>
          <li>Select the uploaded datasets <code class="highlighter-rouge">subset_1.fastq.gz</code> and <code class="highlighter-rouge">subset_2.fastq.gz</code> as the fastq files</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p>Go to the web page result page and have a closer look at ‘Per base sequence content’</p>

      <p><img src="../../images/fastqc.png" alt=""></p>

      <blockquote class="question">
        <h3 id="question-questions">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>Note the GC distribution and percentage of “T” and “C”. Why is this so weird?</li>
          <li>
            <p>Is everything as expected?</p>

            <details>
 <summary>Click to view answers</summary>
 <ol type="1">
 <li>The attentive audience of the theory part knows: Every C-meth stays a C and every normal C becomes a T during the bisulfite conversion. </li>
 <li>Yes it is. Always be careful and have the specific characteristics of your data in mind during the interpretation of FastQC results.</li>
 </ol>
 </details>
          </li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h1 id="alignment">Alignment</h1>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-mapping-with-bwameth">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Mapping with bwameth</h3>

  <p>We will map now the imported dataset against a reference genome.</p>

  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">bwameth</code>
</li>
    <li>
<strong>bwameth</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Select for the option <code class="highlighter-rouge">Select a genome reference from your history or a built-in index?</code> <code class="highlighter-rouge">Use a built-in idex</code> and here the human <code class="highlighter-rouge">hg38</code> genome.</li>
    <li>
<strong>bwameth</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose for the option <code class="highlighter-rouge">Is this library mate-paired?</code> <code class="highlighter-rouge">Paired-end</code> and use the two imported datasets as an input.</li>
    <li>
      <p><strong>bwameth</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Compute now the alignment. Please notice that depending on your system this computation can take some time. If you want to skip this, we provide for you a precomputed alignment. Import <code class="highlighter-rouge">aligned_subset.bam</code> to your history.</p>

      <blockquote class="question">
        <h3 id="question-questions-1">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>
            <p>Why we need other alignment tools for bisulfite sequencing data?</p>

            <details>
<summary>Click to view answers</summary>
<ol type="1">
<li>You may have noticed that all the C's are C-meth's and a T can be a T or a C. A mapper for methylation data needs to find out what is what.</li>
</ol>
</details>
          </li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h1 id="methylation-bias-and-metric-extraction">Methylation bias and metric extraction</h1>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-methylation-bias">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Methylation bias</h3>

  <p>We will extract the methylation on the resulting BAM file of the alignment step.</p>

  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">MethylDackel</code>
</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose at the first option <code class="highlighter-rouge">Load reference genome from</code> <code class="highlighter-rouge">Local cache</code> and for <code class="highlighter-rouge">Using reference genome</code> the value <code class="highlighter-rouge">hg38</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Select for the option <code class="highlighter-rouge">sorted_alignments.bam</code> the computed bam file of step 4 of the <code class="highlighter-rouge">bwameth</code> alignment.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use for <code class="highlighter-rouge">What do you want to do?</code> the value <code class="highlighter-rouge">Determine the position-dependent methylation bias in the dataset, producing diagnostic SVG images</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Set the parameters <code class="highlighter-rouge">keepSingleton</code> and <code class="highlighter-rouge">keepDiscordant</code> to <code class="highlighter-rouge">Yes</code>.</li>
    <li>
      <p><strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Click <code class="highlighter-rouge">Execute</code>.</p>

      <p><img src="../../images/methylation_bias_example_data.png" alt=""></p>

      <blockquote class="question">
        <h3 id="question-questions-2">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>Consider the <code class="highlighter-rouge">original top strand</code> output. Is there a methylation bias?</li>
          <li>
            <p>If we would trim, what would be the start and the end positions?</p>

            <details>
 <summary>Click to view answers</summary>
 <ol type="1">
 <li>The distribution of the methylation is more or less equal. Only at the start and the end we could trim a bit but a +- 5% variation is acceptable. </li>
 <li>To trim the reads we would include for the first strand only the positions 0 to 145, for the second 6 to 149.</li>
 </ol>
 </details>
          </li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-methylation-extraction-with-methyldackel">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Methylation extraction with MethylDackel</h3>

  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool ‘MethylDackel’</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose at the first option <code class="highlighter-rouge">Load reference genome from</code> the value: <code class="highlighter-rouge">Local cache</code> and for <code class="highlighter-rouge">Using reference genome</code> the value: <code class="highlighter-rouge">hg38</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Select for the option <code class="highlighter-rouge">sorted_alignments.bam</code> the computed bam file of step 4 of the <code class="highlighter-rouge">bwameth</code> alignment.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use for <code class="highlighter-rouge">What do you want to do?</code> the value <code class="highlighter-rouge">Extract methylation metrics from an alignment file in BAM/CRAN format</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose <code class="highlighter-rouge">Yes</code> for the option <code class="highlighter-rouge">Merge per-Cytosine metrics from CpG and CHG contexts into per-CPG or per-CHG metrics</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Set the parameter <code class="highlighter-rouge">fraction</code> to <code class="highlighter-rouge">Yes</code>.</li>
    <li>
<strong>MethylDackel</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: All other options use the default value.</li>
  </ol>

</blockquote>

<h1 id="visualization">Visualization</h1>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on:</h3>

  <p>We visualize the example with the help of deepTools.</p>

  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">Wig/BedGraph-to-bigWig</code>
</li>
    <li>
      <p><strong>Wig/BedGraph-to-bigWig</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use the result of MethylDackel to transform it to a bigWig file.</p>

      <blockquote class="question">
        <h3 id="question-questions-3">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>
            <p>The execution fails. Do you have an idea why?</p>

            <details>
 <summary>Click to view answers</summary>
 <ol type="1">
 <li>The output file is having one line too much in in the beginning and column five and six should not be there. We need to fix this.</li>
 </ol>
 </details>
          </li>
        </ul>
      </blockquote>
    </li>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for <code class="highlighter-rouge">tail</code>. use <code class="highlighter-rouge">Select last lines from a dataset (tail)</code>
</li>
    <li>
<strong>tail</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use the mode <code class="highlighter-rouge">Operation</code> the value <code class="highlighter-rouge">Keep everything from this line on</code> and choose <code class="highlighter-rouge">2</code> as a value.</li>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for awk</li>
    <li>
<strong>awk</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Convert with awk the bedgraph file and use as <code class="highlighter-rouge">AWK Program</code>: <code class="highlighter-rouge">'BEGIN{OFS="\t"}{print $1, $2, $3, $4}'</code>
</li>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">computeMatrix</code>.</li>
    <li>
<strong>computeMatrix</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use the file <code class="highlighter-rouge">CpGIslands.bed</code>as <code class="highlighter-rouge">Regions to plot</code> and the in the previous step created bigwig file as the <code class="highlighter-rouge">score file</code>.</li>
    <li>
<strong>computeMatrix</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use for the option <code class="highlighter-rouge">computeMatrix has two main output options</code> the value <code class="highlighter-rouge">reference-point</code>.</li>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">plotProfile</code>.</li>
    <li>
<strong>plotProfile</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose for <code class="highlighter-rouge">Matrix file from the computeMatrix tool</code> the computed matrix from the tool <code class="highlighter-rouge">computeMatrix</code>.</li>
  </ol>

  <p>The output should look something like this:</p>

  <p><img src="../../images/methylation_output.png" alt=""></p>

  <p>Lets see how the methylation looks for a view provided files:</p>
  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Import from the data library the files <code class="highlighter-rouge">NB1_CpG.meth.bedGraph</code>
</li>
    <li>
      <p><strong>Wig/BedGraph-to-bigWig</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Use the imported file to transform it to a bigWig file.</p>

      <blockquote class="question">
        <h3 id="question-questions-4">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>
            <p>The execution fails. Do you have an idea why?</p>

            <details>
 <summary>Click to view answers</summary>
 <ol type="1">
 <li>A conversion to bigWig would fail right now, probably with some error message like <code>hashMustFindVal: '1' not found</code>. The reason is the source of the reference genome which was used. There is ensembl and UCSC as sources which differ in naming the chromosomes. Ensembl is using just numbers e.g. 1 for chromosome one. UCSC is using chr1 for the same. Be careful with this especially if you have data from different sources. We need to convert this.</li>
 </ol>
 </details>
          </li>
        </ul>
      </blockquote>
    </li>
    <li>
<strong>Replace column</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle"> Every chromosome is named different, the list to transfer the ensembl notation to ucsc notation is having more than 500 entries. To convert it you can use the tool <strong>Replace column</strong>. Choose for <code class="highlighter-rouge">File in which you want to replace some values</code> the bedGraph file and for <code class="highlighter-rouge">Replace information file</code> <a href="https://raw.githubusercontent.com/dpryan79/ChromosomeMappings/master/GRCh38_ensembl2UCSC.txt">this</a> conversion file. For <code class="highlighter-rouge">Which column should be replaced?</code> choose <code class="highlighter-rouge">Column: 1</code>, for <code class="highlighter-rouge">Skip this many starting lines</code> a <code class="highlighter-rouge">1</code> and for <code class="highlighter-rouge">Delimited by</code> <code class="highlighter-rouge">Tab</code>. In case this tool is not available in your galaxy instance, we precomputed the files for you: Please import <code class="highlighter-rouge">NB1_CpG.meth_ucsc.bedGraph</code>, <code class="highlighter-rouge">NB2_CpG.meth_ucsc.bedGraph</code>, <code class="highlighter-rouge">BT089_CpG.meth_ucsc.bedGraph</code>, <code class="highlighter-rouge">BT126_CpG.meth_ucsc.bedGraph</code> and  <code class="highlighter-rouge">BT198_CpG.meth_ucsc.bedGraph</code>.</li>
    <li>Compute the matrix and plot the profile as described above.</li>
  </ol>

  <p>More information about deepTools can be found here: https://deeptools.github.io/</p>

</blockquote>

<h1 id="metilene">Metilene</h1>

<blockquote class="hands_on">
  <h3 id="pencil2-hands-on-metilene">
<img class="emoji" title=":pencil2:" alt=":pencil2:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/270f.png" height="20" width="20" align="absmiddle"> Hands-on: Metilene</h3>

  <p>With metilene it is possible to detect differentially methylated regions (DMRs) which is a necessary prerequisite for characterizing different epigenetic states.</p>

  <ol>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Import from the data library the files <code class="highlighter-rouge">NB1_CpG.meth.bedGraph</code>, <code class="highlighter-rouge">NB2_CpG.meth.bedGraph</code>, <code class="highlighter-rouge">BT089_CpG.meth.bedGraph</code>, <code class="highlighter-rouge">BT126_CpG.meth.bedGraph</code> and  <code class="highlighter-rouge">BT198_CpG.meth.bedGraph</code>.</li>
    <li>
<strong>Galaxy</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Search for the tool <code class="highlighter-rouge">Metilene</code>
</li>
    <li>
<strong>Metilene</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Choose for the first option <code class="highlighter-rouge">Input group 1</code> the imported files starting with <code class="highlighter-rouge">NB</code> and for <code class="highlighter-rouge">Input group 2</code> the imported files <code class="highlighter-rouge">Input group 2</code>.</li>
    <li>
<strong>Metilene</strong> <img class="emoji" title=":wrench:" alt=":wrench:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f527.png" height="20" width="20" align="absmiddle">: Select for the option <code class="highlighter-rouge">BED file containing regions of interest</code> the imported BAM file CpGIslands.bed.</li>
    <li>
      <p>More information about metilene can be found here: https://www.bioinf.uni-leipzig.de/Software/metilene/</p>

      <blockquote class="question">
        <h3 id="question-questions-5">
<img class="emoji" title=":question:" alt=":question:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2753.png" height="20" width="20" align="absmiddle"> Questions</h3>

        <ul>
          <li>
            <p>Have a look at the produced pdf document. What is the data showing?</p>

            <details>
 <summary>Click to view answers</summary>
 <ol type="1">
 <li>It shows the distribution of DMR differences, DMR length in nucleotides and number CpGs, DMR differences vs. q-values, mean methylation group 1 vs. mean methylation group 2 and DMR length in nucleotides vs. length in CpGs</li>
 </ol>
 </details>
          </li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>


    
    <blockquote class="key_points">
        <h3> <img class="emoji" title=":grey_exclamation:" alt=":grey_exclamation:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2755.png" height="20" width="20" align="absmiddle"> Key points</h3>

        <ul>
        
           <li>The output of a methylation NGS is having a different distribution of the four bases. This is caused by the bisulfite treatment of the DNA.</li>
        
           <li>If there is a different level of methylation in the loci of a gene this can be a hint that something is wrong.</li>
        
           <li>To get useful results you need -- data, data and data!</li>
        
        </ul>
    </blockquote>
    

    
      <h1>Useful literature</h1>
      <p>Useful information regarding this type of analysis with descriptions and paper references for the tools used in this tutorial, and literature for this analysis techniques and interpretations can be found <a href="https://galaxyproject.github.io/training-material//topics/epigenetics#references">here</a>.</p>
    

    <h3>
<img class="emoji" title=":clap:" alt=":clap:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f44f.png" height="20" width="20" align="absmiddle"> Congratulations on successfully completing this tutorial!</h3>


    <hr>
    <blockquote class="overview">
        <h3> <img class="emoji" title=":speech_balloon:" alt=":speech_balloon:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f4ac.png" height="20" width="20" align="absmiddle"> Feedback</h3>
        Please take a moment and provide your feedback on this tutorial. Your feedback will help guide and improve future revisions to this tutorial. <a href="https://tinyurl.com/GTNfeedback" target="_blank">Feedback Form</a>
    </blockquote>

    <i>This material is the result of a collaborative work. Thanks the <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a> and all the contributors
    
    !<br>
    <br>
    Found a typo? Something is wrong in this tutorial? Edit it on <a href="https://github.com/galaxyproject/training-material/tree/master/topics/epigenetics/tutorials/methylation-seq/tutorial.md">GitHub</a>.</i>
</section>

        </div>
    </body>
    <script src="https://galaxyproject.github.io/training-material//assets/js/landing_page.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</html>
