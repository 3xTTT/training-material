*** Code Mardown ***
*********************

RAD-Seq Analysis on Galaxy, STACKS example
=========================================

:grey_question: ***Questions***

-*Create a genetic map with Reduced Representation Libraries (RRL) data such as tags associated with restriction sites (RAD-tags)*
-*Identify selection markers* 

:dart: ***Objectives***

-*Illumina data pretreatment: getting rid of bad quality reads and demultiplexing barcoded samples*
-*Mapping RAD sequences on reference genome*
-*Learning how to use STACKS to assemble RAD loci, detect SNPs, genotypes and haplotypes for each individuals from two population*
-*Bringing out statistics* 
-*Extend what has been learnt to more complexe problems*


:heavy_check_mark: ***Requirements***
-*Galaxy introduction*
-*RAD-Seq technology*
-*not necessary to have a reference genome*

:hourglass: ***Time estimation*** *1d*

[:book: **Associated slide deck**](http://......html)


# Introduction

    Through a serie of exercises, you will learn how to analyze Reduced Representation Libraries (RRL) data generated by Illumina sequencing platform. We will focus on tags associated with restriction sites (RAD). This type of libraries are often used for genotyping by sequencing, and can generate high density SNP markers (single nucleotide polymorphism) spread over the genome.
You will learn to do so using a pipeline especially designed for this kind of analysis: STACKS.
Data will be used to create un genetic map and to identify putative specific selection markers.

Software that will be uses are Open Source softwares:
-*BWA (http://bio-bwa.sourceforge.net/) is used to map the reads against the reference genome. We will use it to map RAD reads against the spotted gar genome, and analyze these reads on the STACKS pipeline*
-*STACKS (http://creskoloab.uoregon.edu/stacks/) is a bundle of interconnected opensource initially developed for de-novo assembly of RAD sequences in loci and genetic map. It is now used to study organisms with or without reference genome. The pipeline contains a Perl wrapper that allows to launch all the programs* 


# RAD-Seq analysis on Galaxy: SNPs detection

## The analysis

:pencil2: ***Hands on!***

1. Create a new history on Galaxy (i.e. "RAD 1 : SNP calling")
2. Data acquisition: download the data available at <http://catchenlab.life.illinois.edu/stacks/tut_gar.php> and upload the male and female files on Galaxy.  
3. Directly execute **STACKS: ustacks** on the two parents selecting the two files as entry data. Since data have already been cleaned up and demultiplexed it will not be necessary to execute **STACKS: Process Radtags**.
4. Specify different parameters:
	* the "unique numeric ID" parameter
	* the "Minimum depth of coverage required to create a stack" (-m). This parameter controls the number of reads **corresponding exactly** to create one stack for an individual. The reads used to constitute the stacks are **primary reads**. The others are **secondary reads**. This parameter is also called "stack-depth" 
	* the maximum distance (in nucleotides) allowed between stacks to be merged into a putative locus (-M). Set it up at 2 nucleotides. This parameter is also called "within-individual distance". Value should be between 2 and 4.

Other paramets can be set to their default value.







  

